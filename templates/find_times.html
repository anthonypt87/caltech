<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<link rel='stylesheet' type='text/css' href='/static/css/fullcalendar.css' />
<link rel='stylesheet' type='text/css' href='/static/css/fullcalendar.print.css' media='print' />
<link type="text/css" href="/static/css/smoothness/jquery-ui-1.8.23.custom.css" rel="stylesheet" />
<link type="text/css" href="/static/css/datepicker.css" rel="stylesheet" />
<script type="text/javascript" src="/static/js/jquery-1.8.1.min.js"></script> 
<script type="text/javascript" src="/static/js/jquery-ui-1.8.23.custom.min.js"></script> 
<script type="text/javascript" src="/static/js/jquery-ui-timepicker-addon.js"></script> 
<script type="text/javascript" src="/static/js/fullcalendar-1.5.3/fullcalendar/fullcalendar.js"></script> 
<script type="text/javascript">
    $(function() {
        $("#id_start_time").datetimepicker({dateFormat: "yy-mm-dd", timeFormat: "hh:mm:ss"});
    });
    $(function() {
        $("#id_end_time").datetimepicker({dateFormat: "yy-mm-dd", timeFormat: "hh:mm:ss"});
    });

    {% if calendar_response %} 
    $(document).ready(function() {
		var calendar = $('#calendar').fullCalendar({
			header: {
				left: '',
				center: 'title',
				right: ''
			},
			defaultView: 'resourceDay',
			minTime: 8,
			maxTime: 19,
            resources: {{calendar_response.json_interviewers|safe}},
            events: {{calendar_response.json_events|safe}},
			height: calcCalendarHeight()
		});
		
		function calcCalendarHeight() {
			var h = $(window).height() - 40;
			console.log(h);
			return h;
		}
		
		$(window).resize(function() {
			$('#calendar').fullCalendar('option', 'height', calcCalendarHeight());
		});
    });
    {% endif %}

</script>
<style type='text/css'>

	#calendar {
		width: 100%;
		}

</style>
</head>
<body>

<h1>Find me the times!</h1>

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<form action="/find_times_post/" method="post">{% csrf_token %}
    {{find_times_form.as_p}}
    <input type="submit" value="Submit"/>
</form>

<div id="calendar"></div>
<div id='contextMenuContainer' style='background-color:#f0f0f0;width:100px;height:100px;display:none;z-index:999;border-radius:5px;border:1px solid black;position:absolute;'></div>

{% if calendar_response %} 
{% for interview_calendar in calendar_response.interview_calendars %} 
{{interview_calendar.interviewer}}
<ul>
    {% for busy_time in interview_calendar.busy_times %} 
    <li>{{busy_time}}</li>
    {% endfor %}
</ul>
{% endfor %}
{% endif %}

<body>
</html>
